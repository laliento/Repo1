<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">

<ui:composition template="/pages/util/template/template.xhtml">
	<ui:define name="content">
		<h:form id="frmKpiNegocio">
		<p:growl id="growl" />
			<p:panel header="#{languageView.bundleMap['lbl_frm_config_kpi']}" align="center">
				<div align="center">
					<h:panelGrid columns="2">
						<h:outputLabel id="lblCodFormato"
							value="#{languageView.bundleMap['lbl_cod_formato']}:" />
						<p:selectOneMenu id="cmbCodFormato"
							value="#{relKpiNegocioView.storeFormatCode}"
							style="width: 390px; text-align: left ! important">
							<f:selectItems value="#{relKpiNegocioView.listTipoNegocio}" />
							<p:ajax listener="#{relKpiNegocioView.cambioNegocio}"
								update="tblKpiNeg,total,btnSave" />
						</p:selectOneMenu>
						<h:outputLabel id="lblTotal"
							value="#{languageView.bundleMap['lbl_kpi_total']}" />
						<h:outputLabel id="total"
						value="#{relKpiNegocioView.total}%" style="font-size:40px;color:
						   #{!(relKpiNegocioView.total eq 100) ? 'red':'green'}
						  "/>
					</h:panelGrid>
					<p:separator />
				</div>
				<div align="center">
				<p:dataTable id="tblKpiNeg" var="kpiNeg" value="#{relKpiNegocioView.lstKpiNegocio}"  
	  			 paginator="false" rows="15" paginatorPosition="bottom"
	  			 styleClass="col_table_center">
			 	<p:column headerText="KPI"
			 		sortBy="#{kpiNeg.kpiNegocioId.kpi.etiqueta}" filterMatchMode="contains">
			            #{kpiNeg.kpiNegocioId.kpi.nombre}  
			    </p:column>
			    <p:column headerText="%"
			 		sortBy="#{kpiNeg.porcentaje}"  filterMatchMode="contains">
               		<pe:inputNumber  id="input5" value="#{kpiNeg.porcentaje}" symbol="%" 
                               symbolPosition="s" required="true" emptyValue="empty" maxValue="#{kpiNeg.maxPorcentaje}" minValue="0">
                   		<p:ajax listener="#{relKpiNegocioView.calculaTotal}"   update=":frmKpiNegocio:total,:frmKpiNegocio:btnSave" />
               		</pe:inputNumber>
			    </p:column>
	</p:dataTable>
	<p:commandButton id="btnSave" value="#{languageView.bundleMap['lbl_cmd_save']}" disabled="#{!(relKpiNegocioView.total eq 100)}" 
	actionListener="#{relKpiNegocioView.guardar}" update=":frmKpiNegocio" icon="ui-icon-check" />
	</div>
			</p:panel>
		</h:form> 
 	<p:dialog id="dlgGrupAttributeRemove" header="#{languageView.bundleMap['btn_delete']}" widgetVar="grupAttributeRemove" resizable="true"  
			              showEffect="clip" hideEffect="fold" modal="true" width="400" height="100">
	    <h:form id="frmKpiNegocioRemove">    
			<p:growl id="grow" showDetail="true" showSummary="false" sticky="false" life="1800"/>
		    		<h:panelGrid id="pnlToolTable" >
						<h:outputText value="#{languageView.bundleMap['msg_delete_config_negocio']}"/>
					</h:panelGrid>							
			<div align="center">
			<h:panelGrid columns="2">
				<p:commandButton value="#{languageView.bundleMap['btn_delete']}"
				 update=":frmKpiNegocio:tblKpiNeg"   
	         			 action="#{relKpiNegocioView.guardar}"/>	
	         			<p:commandButton value="#{languageView.bundleMap['btn_cancelar']}" 	
	         									oncomplete="grupAttributeRemove.hide()"/>
			</h:panelGrid>
			</div>
		</h:form>
	</p:dialog>
	</ui:define>
</ui:composition>
</html>